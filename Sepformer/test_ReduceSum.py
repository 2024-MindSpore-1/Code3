from mindspore import Tensor
import mindspore.ops as ops
import mindspore.numpy as np
import mindspore.common.dtype as mstype
import math
from mindspore import context

target = "Ascend"
device_id = 2

# init context
# context.set_context(mode=context.GRAPH_MODE, device_target=target, save_graphs=False)
context.set_context(mode=context.PYNATIVE_MODE, device_target=target, save_graphs=False)
context.set_context(device_id=device_id)
source = Tensor([[[0, 1],
                  [0, 1]],

                 [[2, 3],
                  [2, 3]],

                 [[4, 5],
                  [4, 5]],

                 [[6, 7],
                  [6, 7]],

                 [[8, 9],
                  [8, 9]],

                 [[10, 11],
                  [10, 11]],

                 [[12, 13],
                  [12, 13]],

                 [[14, 15],
                  [14, 15]],

                 [[16, 17],
                  [16, 17]],

                 [[18, 19],
                  [18, 19]],

                 [[20, 21],
                  [20, 21]],

                 [[22, 23],
                  [22, 23]],

                 [[24, 25],
                  [24, 25]],

                 [[26, 27],
                  [26, 27]],

                 [[28, 29],
                  [28, 29]],

                 [[30, 31],
                  [30, 31]],

                 [[32, 33],
                  [32, 33]],

                 [[34, 35],
                  [34, 35]],

                 [[36, 37],
                  [36, 37]],

                 [[38, 39],
                  [38, 39]],

                 [[40, 41],
                  [40, 41]],

                 [[42, 43],
                  [42, 43]],

                 [[44, 45],
                  [44, 45]],

                 [[46, 47],
                  [46, 47]],

                 [[48, 49],
                  [48, 49]],

                 [[50, 51],
                  [50, 51]],

                 [[52, 53],
                  [52, 53]],

                 [[54, 55],
                  [54, 55]],

                 [[56, 57],
                  [56, 57]],

                 [[58, 59],
                  [58, 59]],

                 [[60, 61],
                  [60, 61]],

                 [[62, 63],
                  [62, 63]],

                 [[64, 65],
                  [64, 65]],

                 [[66, 67],
                  [66, 67]],

                 [[68, 69],
                  [68, 69]],

                 [[70, 71],
                  [70, 71]],

                 [[72, 73],
                  [72, 73]],

                 [[74, 75],
                  [74, 75]],

                 [[76, 77],
                  [76, 77]],

                 [[78, 79],
                  [78, 79]],

                 [[80, 81],
                  [80, 81]],

                 [[82, 83],
                  [82, 83]],

                 [[84, 85],
                  [84, 85]],

                 [[86, 87],
                  [86, 87]],

                 [[88, 89],
                  [88, 89]],

                 [[90, 91],
                  [90, 91]],

                 [[92, 93],
                  [92, 93]],

                 [[94, 95],
                  [94, 95]],

                 [[96, 97],
                  [96, 97]],

                 [[98, 99],
                  [98, 99]],

                 [[100, 101],
                  [100, 101]],

                 [[102, 103],
                  [102, 103]],

                 [[104, 105],
                  [104, 105]],

                 [[106, 107],
                  [106, 107]],

                 [[108, 109],
                  [108, 109]],

                 [[110, 111],
                  [110, 111]],

                 [[112, 113],
                  [112, 113]],

                 [[114, 115],
                  [114, 115]],

                 [[116, 117],
                  [116, 117]],

                 [[118, 119],
                  [118, 119]],

                 [[120, 121],
                  [120, 121]],

                 [[122, 123],
                  [122, 123]],

                 [[124, 125],
                  [124, 125]],

                 [[126, 127],
                  [126, 127]],

                 [[128, 129],
                  [128, 129]],

                 [[130, 131],
                  [130, 131]],

                 [[132, 133],
                  [132, 133]],

                 [[134, 135],
                  [134, 135]],

                 [[136, 137],
                  [136, 137]],

                 [[138, 139],
                  [138, 139]],

                 [[140, 141],
                  [140, 141]],

                 [[142, 143],
                  [142, 143]],

                 [[144, 145],
                  [144, 145]],

                 [[146, 147],
                  [146, 147]],

                 [[148, 149],
                  [148, 149]],

                 [[150, 151],
                  [150, 151]],

                 [[152, 153],
                  [152, 153]],

                 [[154, 155],
                  [154, 155]],

                 [[156, 157],
                  [156, 157]],

                 [[158, 159],
                  [158, 159]],

                 [[160, 161],
                  [160, 161]],

                 [[162, 163],
                  [162, 163]],

                 [[164, 165],
                  [164, 165]],

                 [[166, 167],
                  [166, 167]],

                 [[168, 169],
                  [168, 169]],

                 [[170, 171],
                  [170, 171]],

                 [[172, 173],
                  [172, 173]],

                 [[174, 175],
                  [174, 175]],

                 [[176, 177],
                  [176, 177]],

                 [[178, 179],
                  [178, 179]],

                 [[180, 181],
                  [180, 181]],

                 [[182, 183],
                  [182, 183]],

                 [[184, 185],
                  [184, 185]],

                 [[186, 187],
                  [186, 187]],

                 [[188, 189],
                  [188, 189]],

                 [[190, 191],
                  [190, 191]],

                 [[192, 193],
                  [192, 193]],

                 [[194, 195],
                  [194, 195]],

                 [[196, 197],
                  [196, 197]],

                 [[198, 199],
                  [198, 199]]])

sum = ops.ReduceSum(keep_dims=True)
error = sum(source, 0)
print(error.shape)
